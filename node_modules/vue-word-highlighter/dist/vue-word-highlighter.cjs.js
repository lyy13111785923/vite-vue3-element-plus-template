"use strict";var e=require("vue-demi"),i=require("diacritics");const t=e=>e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&"),s=(s,r,h=!1)=>{if(!r.query||r.query instanceof String&&!r.query.trim())return s;let l=s,a=r.query,g=!1;r.diacriticsSensitive||(l=i.remove(l),a=r.query instanceof RegExp?r.query:i.remove(r.query),g=l!==s);const n=(e=>{let i;if(e.query instanceof RegExp)return new RegExp(String.raw`(${e.query.source})`,"g"+(e.caseSensitive?"":"i"));if(e.splitBySpace){const s=e.query.trim().replace(/\s+/g," ");i=String.raw`(${s.split(/\s/).map(t).join("|")})`}else i=String.raw`(${t(e.query)})`;return new RegExp(String.raw`${i}`,"g"+(e.caseSensitive?"":"i"))})({query:a,splitBySpace:r.splitBySpace,caseSensitive:r.caseSensitive}),p=l.split(n),c=g?((e,i)=>{const t=[];return i.forEach((i=>{const s=t.join("").length,r=s+i.length;t.push(e.slice(s,r))})),t})(s,p):p;return h?p.map(((e,i)=>{if(n.test(e)){const e=r.highlightClass?` class="${r.highlightClass}"`:"",t=r.highlightStyle?` style="${r.highlightStyle}"`:"";return`<${r.highlightTag}${e}${t}>${c[i]}</${r.highlightTag}>`}return c[i]})).join(""):p.map(((i,t)=>n.test(i)?e.h(r.highlightTag,{class:r.highlightClass,style:r.highlightStyle},c[t]):c[t]))},r=e=>Array.isArray(e.children)?e.children.map(r).join(""):e.children??"",h=i=>"string"==typeof i?[]:i.filter((e=>"string"!=typeof e)).map((i=>"string"==typeof i?i:e.isVue3?i.children:i.children[0].text));e.install();var l=e.defineComponent({name:"VueWordHighlighter",props:{query:{type:[String,RegExp],required:!0,default:""},caseSensitive:{type:Boolean,default:!1},diacriticsSensitive:{type:Boolean,default:!1},splitBySpace:{type:Boolean,default:!1},highlightClass:{type:[Object,String,Array],default:""},highlightStyle:{type:[Object,String,Array],default:""},highlightTag:{type:String,default:"mark"},wrapperTag:{type:String,default:"span"},wrapperClass:{type:[Object,String,Array],default:""},textToHighlight:{type:String,default:""},htmlToHighlight:{type:String,default:""}},emits:["matches"],setup:(i,t)=>()=>{if(i.htmlToHighlight){if(!e.isVue3)throw new Error("htmlToHighlight prop is only supported in Vue 3");const t="(<(?:\"[^\"]*\"['\"]*|'[^']*'['\"]*|[^'\">])+>)",r=i.htmlToHighlight.split(new RegExp(t,"gs")),h=r.map(((e,h)=>new RegExp(t).test(e)||h>0&&r[h-1].startsWith("<script")?e:s(e,{query:i.query,splitBySpace:i.splitBySpace,caseSensitive:i.caseSensitive,diacriticsSensitive:i.diacriticsSensitive,highlightTag:i.highlightTag,highlightClass:i.highlightClass,highlightStyle:i.highlightStyle},!0))).join("");return e.h(i.wrapperTag,{class:i.wrapperClass,innerHTML:h})}if(i.textToHighlight){const r=s(i.textToHighlight,{query:i.query,splitBySpace:i.splitBySpace,caseSensitive:i.caseSensitive,diacriticsSensitive:i.diacriticsSensitive,highlightTag:i.highlightTag,highlightClass:i.highlightClass,highlightStyle:i.highlightStyle});return t.emit("matches",h(r)),e.h(i.wrapperTag,{class:i.wrapperClass},r)}if(!e.isVue3){const l=(i=>{if(i&&i.default){const t=i.default();let s;return s=e.isVue3?r(t[0]):t[0].text,"string"==typeof s?s:("production"!==process.env.NODE_ENV&&console.warn("Slots should be text only"),"")}return""})(t.slots),a=s(l,{query:i.query,splitBySpace:i.splitBySpace,caseSensitive:i.caseSensitive,diacriticsSensitive:i.diacriticsSensitive,highlightTag:i.highlightTag,highlightClass:i.highlightClass,highlightStyle:i.highlightStyle});return t.emit("matches",h(a)),e.h(i.wrapperTag,{class:i.wrapperClass},a)}if(t.slots&&t.slots.default){const r=l=>{if("string"==typeof l.children){const r=s(l.children,{query:i.query,splitBySpace:i.splitBySpace,caseSensitive:i.caseSensitive,diacriticsSensitive:i.diacriticsSensitive,highlightTag:i.highlightTag,highlightClass:i.highlightClass,highlightStyle:i.highlightStyle}),a=h(r);return t.emit("matches",a),0===a.length?l:"string"==typeof l.type?e.h(l.type,{...l.props},[e.h(i.wrapperTag,{class:i.wrapperClass},r)]):e.h(i.wrapperTag,{class:i.wrapperClass},r)}return e.h(l.type,{...l.props},Array.isArray(l.children)?l.children.map((e=>r(e))):[])},l=t.slots.default();return Array.isArray(l)?l.map((e=>r(e))):l}}});module.exports=l;//# sourceMappingURL=vue-word-highlighter.cjs.js.map
