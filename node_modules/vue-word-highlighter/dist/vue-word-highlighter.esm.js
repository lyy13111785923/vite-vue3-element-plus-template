import{h as i,isVue3 as e,install as t,defineComponent as s}from"vue-demi";import r from"diacritics";const l=i=>i.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&"),h=(e,t,s=!1)=>{if(!t.query||t.query instanceof String&&!t.query.trim())return e;let h=e,a=t.query,g=!1;t.diacriticsSensitive||(h=r.remove(h),a=t.query instanceof RegExp?t.query:r.remove(t.query),g=h!==e);const n=(i=>{let e;if(i.query instanceof RegExp)return new RegExp(String.raw`(${i.query.source})`,"g"+(i.caseSensitive?"":"i"));if(i.splitBySpace){const t=i.query.trim().replace(/\s+/g," ");e=String.raw`(${t.split(/\s/).map(l).join("|")})`}else e=String.raw`(${l(i.query)})`;return new RegExp(String.raw`${e}`,"g"+(i.caseSensitive?"":"i"))})({query:a,splitBySpace:t.splitBySpace,caseSensitive:t.caseSensitive}),p=h.split(n),c=g?((i,e)=>{const t=[];return e.forEach((e=>{const s=t.join("").length,r=s+e.length;t.push(i.slice(s,r))})),t})(e,p):p;return s?p.map(((i,e)=>{if(n.test(i)){const i=t.highlightClass?` class="${t.highlightClass}"`:"",s=t.highlightStyle?` style="${t.highlightStyle}"`:"";return`<${t.highlightTag}${i}${s}>${c[e]}</${t.highlightTag}>`}return c[e]})).join(""):p.map(((e,s)=>n.test(e)?i(t.highlightTag,{class:t.highlightClass,style:t.highlightStyle},c[s]):c[s]))},a=i=>Array.isArray(i.children)?i.children.map(a).join(""):i.children??"",g=i=>"string"==typeof i?[]:i.filter((i=>"string"!=typeof i)).map((i=>"string"==typeof i?i:e?i.children:i.children[0].text));t();var n=s({name:"VueWordHighlighter",props:{query:{type:[String,RegExp],required:!0,default:""},caseSensitive:{type:Boolean,default:!1},diacriticsSensitive:{type:Boolean,default:!1},splitBySpace:{type:Boolean,default:!1},highlightClass:{type:[Object,String,Array],default:""},highlightStyle:{type:[Object,String,Array],default:""},highlightTag:{type:String,default:"mark"},wrapperTag:{type:String,default:"span"},wrapperClass:{type:[Object,String,Array],default:""},textToHighlight:{type:String,default:""},htmlToHighlight:{type:String,default:""}},emits:["matches"],setup:(t,s)=>()=>{if(t.htmlToHighlight){if(!e)throw new Error("htmlToHighlight prop is only supported in Vue 3");const s="(<(?:\"[^\"]*\"['\"]*|'[^']*'['\"]*|[^'\">])+>)",r=t.htmlToHighlight.split(new RegExp(s,"gs")),l=r.map(((i,e)=>new RegExp(s).test(i)||e>0&&r[e-1].startsWith("<script")?i:h(i,{query:t.query,splitBySpace:t.splitBySpace,caseSensitive:t.caseSensitive,diacriticsSensitive:t.diacriticsSensitive,highlightTag:t.highlightTag,highlightClass:t.highlightClass,highlightStyle:t.highlightStyle},!0))).join("");return i(t.wrapperTag,{class:t.wrapperClass,innerHTML:l})}if(t.textToHighlight){const e=h(t.textToHighlight,{query:t.query,splitBySpace:t.splitBySpace,caseSensitive:t.caseSensitive,diacriticsSensitive:t.diacriticsSensitive,highlightTag:t.highlightTag,highlightClass:t.highlightClass,highlightStyle:t.highlightStyle});return s.emit("matches",g(e)),i(t.wrapperTag,{class:t.wrapperClass},e)}if(!e){const r=(i=>{if(i&&i.default){const t=i.default();let s;return s=e?a(t[0]):t[0].text,"string"==typeof s?s:("production"!==process.env.NODE_ENV&&console.warn("Slots should be text only"),"")}return""})(s.slots),l=h(r,{query:t.query,splitBySpace:t.splitBySpace,caseSensitive:t.caseSensitive,diacriticsSensitive:t.diacriticsSensitive,highlightTag:t.highlightTag,highlightClass:t.highlightClass,highlightStyle:t.highlightStyle});return s.emit("matches",g(l)),i(t.wrapperTag,{class:t.wrapperClass},l)}if(s.slots&&s.slots.default){const e=r=>{if("string"==typeof r.children){const e=h(r.children,{query:t.query,splitBySpace:t.splitBySpace,caseSensitive:t.caseSensitive,diacriticsSensitive:t.diacriticsSensitive,highlightTag:t.highlightTag,highlightClass:t.highlightClass,highlightStyle:t.highlightStyle}),l=g(e);return s.emit("matches",l),0===l.length?r:"string"==typeof r.type?i(r.type,{...r.props},[i(t.wrapperTag,{class:t.wrapperClass},e)]):i(t.wrapperTag,{class:t.wrapperClass},e)}return i(r.type,{...r.props},Array.isArray(r.children)?r.children.map((i=>e(i))):[])},r=s.slots.default();return Array.isArray(r)?r.map((i=>e(i))):r}}});export{n as default};//# sourceMappingURL=vue-word-highlighter.esm.js.map
